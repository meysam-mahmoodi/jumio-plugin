"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var nsjumioplugin_common_1 = require("./nsjumioplugin.common");
var Nsjumioplugin = (function (_super) {
    __extends(Nsjumioplugin, _super);
    function Nsjumioplugin() {
        return _super.call(this) || this;
    }
    Nsjumioplugin.prototype.start = function (merchantApiToken, merchantApiSecret, customerEmail, cancelWithError, finishInitWithError, finishedScan) {
        var _this = this;
        this.cancelWithError = cancelWithError;
        this.finishInitWithError = finishInitWithError;
        this.finishedScan = finishedScan;
        console.log("EEEEEEEEEEEE greet 7");
        var config = this.config;
        config = NetverifyConfiguration.new();
        config.merchantApiToken = merchantApiToken;
        config.merchantApiSecret = merchantApiSecret;
        this.delegate = NsjumiopluginDelegateImpl.createWithOwnerResultCallback(new WeakRef(this), this.rootVC(), function (netverifyViewController, documentData, scanReference) {
            _this.finishedScan(documentData);
        });
        config.delegate = this.delegate;
        config.customerId = customerEmail;
        try {
            this.netverifyViewController = NetverifyViewController.alloc().initWithConfiguration(config);
            this.rootVC().presentViewControllerAnimatedCompletion(this.netverifyViewController, false, function () {
                console.log('EEEEEEEEEEEE done');
            });
        }
        catch (e) {
            console.log('EEEEEEEEEEEE EXCEPTION HANDLED:', e);
        }
    };
    Nsjumioplugin.prototype.rootVC = function () {
        var appWindow = UIApplication.sharedApplication.keyWindow;
        return appWindow.rootViewController;
    };
    return Nsjumioplugin;
}(nsjumioplugin_common_1.Common));
exports.Nsjumioplugin = Nsjumioplugin;
var NsjumiopluginDelegateImpl = (function (_super) {
    __extends(NsjumiopluginDelegateImpl, _super);
    function NsjumiopluginDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    NsjumiopluginDelegateImpl_1 = NsjumiopluginDelegateImpl;
    NsjumiopluginDelegateImpl.new = function () {
        return _super.new.call(this);
    };
    NsjumiopluginDelegateImpl.createWithOwnerResultCallback = function (owner, vc, callback) {
        var delegate = NsjumiopluginDelegateImpl_1.new();
        delegate._owner = owner;
        delegate._callback = callback;
        delegate._vc = vc;
        return delegate;
    };
    NsjumiopluginDelegateImpl.prototype.netverifyViewControllerDidCancelWithErrorScanReference = function (netverifyViewController, error, scanReference) {
        console.log("EEEEEEEEEEE 1");
        this._vc.dismissViewControllerAnimatedCompletion(true, null);
        this._owner.get().netverifyViewController.destroy();
    };
    NsjumiopluginDelegateImpl.prototype.netverifyViewControllerDidFinishInitializingWithError = function (netverifyViewController, error) {
        console.log("EEEEEEEEEEE 2");
        if (error) {
            this._vc.dismissViewControllerAnimatedCompletion(true, null);
            this._owner.get().netverifyViewController.destroy();
        }
    };
    NsjumiopluginDelegateImpl.prototype.netverifyViewControllerDidFinishWithDocumentDataScanReference = function (netverifyViewController, documentData, scanReference) {
        console.log("EEEEEEEEEEE 3");
        console.log("finished successfully with scan reference: %@", scanReference);
        this._callback(netverifyViewController, documentData, scanReference);
        this._vc.dismissViewControllerAnimatedCompletion(true, null);
        this._owner.get().netverifyViewController.destroy();
    };
    NsjumiopluginDelegateImpl = NsjumiopluginDelegateImpl_1 = __decorate([
        ObjCClass(NetverifyViewControllerDelegate)
    ], NsjumiopluginDelegateImpl);
    return NsjumiopluginDelegateImpl;
    var NsjumiopluginDelegateImpl_1;
}(NSObject));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibnNqdW1pb3BsdWdpbi5pb3MuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJuc2p1bWlvcGx1Z2luLmlvcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLCtEQUFnRDtBQUdoRDtJQUFtQyxpQ0FBTTtJQVNyQztlQUNJLGlCQUFPO0lBR1gsQ0FBQztJQUVNLDZCQUFLLEdBQVosVUFBYSxnQkFBZ0IsRUFBRSxpQkFBaUIsRUFBRSxhQUFhLEVBQUUsZUFBZSxFQUFFLG1CQUFtQixFQUFFLFlBQVk7UUFBbkgsaUJBaUNDO1FBaENHLElBQUksQ0FBQyxlQUFlLEdBQUcsZUFBZSxDQUFDO1FBQ3ZDLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxtQkFBbUIsQ0FBQztRQUMvQyxJQUFJLENBQUMsWUFBWSxHQUFHLFlBQVksQ0FBQztRQUVqQyxPQUFPLENBQUMsR0FBRyxDQUFDLHNCQUFzQixDQUFDLENBQUM7UUFFcEMsSUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUN6QixNQUFNLEdBQUcsc0JBQXNCLENBQUMsR0FBRyxFQUFFLENBQUM7UUFDdEMsTUFBTSxDQUFDLGdCQUFnQixHQUFHLGdCQUFnQixDQUFDO1FBQzNDLE1BQU0sQ0FBQyxpQkFBaUIsR0FBRyxpQkFBaUIsQ0FBQztRQUM3QyxJQUFJLENBQUMsUUFBUSxHQUFHLHlCQUF5QixDQUFDLDZCQUE2QixDQUNuRSxJQUFJLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFDakIsSUFBSSxDQUFDLE1BQU0sRUFBRSxFQUNiLFVBQUMsdUJBQWdELEVBQUUsWUFBbUMsRUFBRSxhQUFxQjtZQUN6RyxLQUFJLENBQUMsWUFBWSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQ3BDLENBQUMsQ0FBQyxDQUFDO1FBQ1AsTUFBTSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDO1FBQ2hDLE1BQU0sQ0FBQyxVQUFVLEdBQUcsYUFBYSxDQUFDO1FBRWxDLElBQUk7WUFDQSxJQUFJLENBQUMs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ZnJvbSAnLi9uc2p1bWlvcGx1Z2luLmNvbW1vbic7XHJcbmltcG9ydCB7IFZpZXcgfSBmcm9tICd0bnMtY29yZS1tb2R1bGVzL3VpL3BhZ2UvcGFnZSc7XHJcblxyXG5leHBvcnQgY2xhc3MgTnNqdW1pb3BsdWdpbiBleHRlbmRzIENvbW1vbiB7XHJcbiAgICBwcml2YXRlIGNhbmNlbFdpdGhFcnJvcjtcclxuICAgIHByaXZhdGUgZmluaXNoSW5pdFdpdGhFcnJvcjtcclxuICAgIHByaXZhdGUgZmluaXNoZWRTY2FuO1xyXG4gICAgbmV0dmVyaWZ5Vmlld0NvbnRyb2xsZXI6IE5ldHZlcmlmeVZpZXdDb250cm9sbGVyO1xyXG5cclxuICAgIHByaXZhdGUgZGVsZWdhdGU7XHJcbiAgICBwcml2YXRlIGNvbmZpZztcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKDEpO1xyXG4gICAgICAgIC8vIHRoaXMuZ3JlZXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhcnQobWVyY2hhbnRBcGlUb2tlbiwgbWVyY2hhbnRBcGlTZWNyZXQsIGN1c3RvbWVyRW1haWwsIGNhbmNlbFdpdGhFcnJvciwgZmluaXNoSW5pdFdpdGhFcnJvciwgZmluaXNoZWRTY2FuKSB7XHJcbiAgICAgICAgdGhpcy5jYW5jZWxXaXRoRXJyb3IgPSBjYW5jZWxXaXRoRXJyb3I7XHJcbiAgICAgICAgdGhpcy5maW5pc2hJbml0V2l0aEVycm9yID0gZmluaXNoSW5pdFdpdGhFcnJvcjtcclxuICAgICAgICB0aGlzLmZpbmlzaGVkU2NhbiA9IGZpbmlzaGVkU2NhbjtcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coXCJFRUVFRUVFRUVFRUUgZ3JlZXQgN1wiKTtcclxuXHJcbiAgICAgICAgbGV0IGNvbmZpZyA9IHRoaXMuY29uZmlnO1xyXG4gICAgICAgIGNvbmZpZyA9IE5ldHZlcmlmeUNvbmZpZ3VyYXRpb24ubmV3KCk7XHJcbiAgICAgICAgY29uZmlnLm1lcmNoYW50QXBpVG9rZW4gPSBtZXJjaGFudEFwaVRva2VuO1xyXG4gICAgICAgIGNvbmZpZy5tZXJjaGFudEFwaVNlY3JldCA9IG1lcmNoYW50QXBpU2VjcmV0O1xyXG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBOc2p1bWlvcGx1Z2luRGVsZWdhdGVJbXBsLmNyZWF0ZVdpdGhPd25lclJlc3VsdENhbGxiYWNrKFxyXG4gICAgICAgICAgICBuZXcgV2Vha1JlZih0aGlzKSxcclxuICAgICAgICAgICAgdGhpcy5yb290VkMoKSxcclxuICAgICAgICAgICAgKG5ldHZlcmlmeVZpZXdDb250cm9sbGVyOiBOZXR2ZXJpZnlWaWV3Q29udHJvbGxlciwgZG9jdW1lbnREYXRhOiBOZXR2ZXJpZnlEb2N1bWVudERhdGEsIHNjYW5SZWZlcmVuY2U6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maW5pc2hlZFNjYW4oZG9jdW1lbnREYXRhKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgY29uZmlnLmRlbGVnYXRlID0gdGhpcy5kZWxlZ2F0ZTtcclxuICAgICAgICBjb25maWcuY3VzdG9tZXJJZCA9IGN1c3RvbWVyRW1haWw7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHRoaXMubmV0dmVyaWZ5Vmlld0NvbnRyb2xsZXIgPSBOZXR2ZXJpZnlWaWV3Q29udHJvbGxlci5hbGxvYygpLmluaXRXaXRoQ29uZmlndXJhdGlvbihjb25maWcpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yb290VkMoKS5wcmVzZW50Vmlld0NvbnRyb2xsZXJBbmltYXRlZENvbXBsZXRpb24oXHJcbiAgICAgICAgICAgICAgICB0aGlzLm5ldHZlcmlmeVZpZXdDb250cm9sbGVyLFxyXG4gICAgICAgICAgICAgICAgZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5fcmFpc2VTaG93bk1vZGFsbHlFdmVudChwYXJlbnQsIGNvbnRleHQsIGNsb3NlQ2FsbGJhY2spO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFRUVFRUVFRUVFRUUgZG9uZScpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnRUVFRUVFRUVFRUVFIEVYQ0VQVElPTiBIQU5ETEVEOicsIGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByb290VkMoKSB7XHJcbiAgICAgICAgY29uc3QgYXBwV2luZG93ID0gVUlBcHBsaWNhdGlvbi5zaGFyZWRBcHBsaWNhdGlvbi5rZXlXaW5kb3c7XHJcbiAgICAgICAgcmV0dXJuIGFwcFdpbmRvdy5yb290Vmlld0NvbnRyb2xsZXI7XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5AT2JqQ0NsYXNzKE5ldHZlcmlmeVZpZXdDb250cm9sbGVyRGVsZWdhdGUpXHJcbmNsYXNzIE5zanVtaW9wbHVnaW5EZWxlZ2F0ZUltcGwgZXh0ZW5kcyBOU09iamVjdCBpbXBsZW1lbnRzIE5ldHZlcmlmeVZpZXdDb250cm9sbGVyRGVsZWdhdGUge1xyXG5cclxuICAgIHByaXZhdGUgX293bmVyOiBXZWFrUmVmPE5zanVtaW9wbHVnaW4+O1xyXG4gICAgcHJpdmF0ZSBfY2FsbGJhY2s6IChuZXR2ZXJpZnlWaWV3Q29udHJvbGxlcjogTmV0dmVyaWZ5Vmlld0NvbnRyb2xsZXIsIGRvY3VtZW50RGF0YTogTmV0dmVyaWZ5RG9jdW1lbnREYXRhLCBzY2FuUmVmZXJlbmNlOiBzdHJpbmcpID0+IHZvaWQ7XHJcbiAgICBfdmM6IFVJVmlld0NvbnRyb2xsZXI7XHJcblxyXG4gICAgc3RhdGljIG5ldygpOiBOc2p1bWlvcGx1Z2luRGVsZWdhdGVJbXBsIHtcclxuICAgICAgICByZXR1cm4gPE5zanVtaW9wbHVnaW5EZWxlZ2F0ZUltcGw+c3VwZXIubmV3KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBjcmVhdGVXaXRoT3duZXJSZXN1bHRDYWxsYmFjayhvd25lcjogV2Vha1JlZjxOc2p1bWlvcGx1Z2luPiwgdmM6IFVJVmlld0NvbnRyb2xsZXIsIGNhbGxiYWNrOiAobmV0dmVyaWZ5Vmlld0NvbnRyb2xsZXI6IE5ldHZlcmlmeVZpZXdDb250cm9sbGVyLCBkb2N1bWVudERhdGE6IE5ldHZlcmlmeURvY3VtZW50RGF0YSwgc2NhblJlZmVyZW5jZTogc3RyaW5nKSA9PiB2b2lkKTogTnNqdW1pb3BsdWdpbkRlbGVnYXRlSW1wbCB7XHJcbiAgICAgIGNvbnN0IGRlbGVnYXRlID0gPE5zanVtaW9wbHVnaW5EZWxlZ2F0ZUltcGw+TnNqdW1pb3BsdWdpbkRlbGVnYXRlSW1wbC5uZXcoKTtcclxuICAgICAgZGVsZWdhdGUuX293bmVyID0gb3duZXI7XHJcbiAgICAgIGRlbGVnYXRlLl9jYWxsYmFjayA9IGNhbGxiYWNrO1xyXG4gICAgICBkZWxlZ2F0ZS5fdmMgPSB2YztcclxuICAgICAgcmV0dXJuIGRlbGVnYXRlO1xyXG4gICAgfVxyXG5cclxuICAgIG5ldHZlcmlmeVZpZXdDb250cm9sbGVyRGlkQ2FuY2VsV2l0aEVycm9yU2NhblJlZmVyZW5jZShuZXR2ZXJpZnlWaWV3Q29udHJvbGxlcjogTmV0dmVyaWZ5Vmlld0NvbnRyb2xsZXIsIGVycm9yOiBOZXR2ZXJpZnlFcnJvciwgc2NhblJlZmVyZW5jZTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJFRUVFRUVFRUVFRSAxXCIpO1xyXG4gICAgICAgIHRoaXMuX3ZjLmRpc21pc3NWaWV3Q29udHJvbGxlckFuaW1hdGVkQ29tcGxldGlvbih0cnVlLCBudWxsKTtcclxuICAgICAgICB0aGlzLl9vd25lci5nZXQoKS5uZXR2ZXJpZnlWaWV3Q29udHJvbGxlci5kZXN0cm95KCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmV0dmVyaWZ5Vmlld0NvbnRyb2xsZXJEaWRGaW5pc2hJbml0aWFsaXppbmdXaXRoRXJyb3I/KG5ldHZlcmlmeVZpZXdDb250cm9sbGVyOiBOZXR2ZXJpZnlWaWV3Q29udHJvbGxlciwgZXJyb3I6IE5ldHZlcmlmeUVycm9yKTogdm9pZCB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJFRUVFRUVFRUVFRSAyXCIpO1xyXG4gICAgICAgIC8vIHRoaXMuZmluaXNoSW5pdFdpdGhFcnJvcigpO1xyXG4gICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgICB0aGlzLl92Yy5kaXNtaXNzVmlld0NvbnRyb2xsZXJBbmltYXRlZENvbXBsZXRpb24odHJ1ZSwgbnVsbCk7XHJcbiAgICAgICAgICAgIHRoaXMuX293bmVyLmdldCgpLm5ldHZlcmlmeVZpZXdDb250cm9sbGVyLmRlc3Ryb3koKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmV0dmVyaWZ5Vmlld0NvbnRyb2xsZXJEaWRGaW5pc2hXaXRoRG9jdW1lbnREYXRhU2NhblJlZmVyZW5jZShuZXR2ZXJpZnlWaWV3Q29udHJvbGxlcjogTmV0dmVyaWZ5Vmlld0NvbnRyb2xsZXIsIGRvY3VtZW50RGF0YTogTmV0dmVyaWZ5RG9jdW1lbnREYXRhLCBzY2FuUmVmZXJlbmNlOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkVFRUVFRUVFRUVFIDNcIik7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJmaW5pc2hlZCBzdWNjZXNzZnVsbHkgd2l0aCBzY2FuIHJlZmVyZW5jZTogJUBcIiwgc2NhblJlZmVyZW5jZSk7XHJcbiAgICAgICAgdGhpcy5fY2FsbGJhY2sobmV0dmVyaWZ5Vmlld0NvbnRyb2xsZXIsIGRvY3VtZW50RGF0YSwgc2NhblJlZmVyZW5jZSk7XHJcbiAgICAgICAgLypcclxuICAgICAgICB0aGlzLmZpbmlzaGVkU2Nhbihkb2N1bWVudERhdGEpO1xyXG5cclxuICAgICAgICBjb25zdCBzZWxlY3RlZENvdW50cnkgPSBkb2N1bWVudERhdGEuc2VsZWN0ZWRDb3VudHJ5O1xyXG4gICAgICAgIGNvbnN0IHNlbGVjdGVkRG9jdW1lbnRUeXBlID0gZG9jdW1lbnREYXRhLnNlbGVjdGVkRG9jdW1lbnRUeXBlO1xyXG4gICAgICAgIGxldCBkb2N1bWVudFR5cGVTdHI7XHJcbiAgICAgICAgc3dpdGNoIChzZWxlY3RlZERvY3VtZW50VHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlIE5ldHZlcmlmeURvY3VtZW50VHlwZURyaXZlckxpY2Vuc2U6XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudFR5cGVTdHIgPSBcIkRMXCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBOZXR2ZXJpZnlEb2N1bWVudFR5cGVJZGVudGl0eUNhcmQ6XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudFR5cGVTdHIgPSBcIklEXCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBOZXR2ZXJpZnlEb2N1bWVudFR5cGVQYXNzcG9ydDpcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50VHlwZVN0ciA9IFwiUFBcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIE5ldHZlcmlmeURvY3VtZW50VHlwZVZpc2E6XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudFR5cGVTdHIgPSBcIlZpc2FcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBpZE51bWJlciA9IGRvY3VtZW50RGF0YS5pZE51bWJlcjtcclxuICAgICAgICBjb25zdCBwZXJzb25hbE51bWJlciA9IGRvY3VtZW50RGF0YS5wZXJzb25hbE51bWJlcjtcclxuICAgICAgICBjb25zdCBpc3N1aW5nRGF0ZSA9IGRvY3VtZW50RGF0YS5pc3N1aW5nRGF0ZTtcclxuICAgICAgICBjb25zdCBleHBpcnlEYXRlID0gZG9jdW1lbnREYXRhLmV4cGlyeURhdGU7XHJcbiAgICAgICAgY29uc3QgaXNzdWluZ0NvdW50cnkgPSBkb2N1bWVudERhdGEuaXNzdWluZ0NvdW50cnk7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9uYWxEYXRhMSA9IGRvY3VtZW50RGF0YS5vcHRpb25hbERhdGExO1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbmFsRGF0YTIgPSBkb2N1bWVudERhdGEub3B0aW9uYWxEYXRhMjtcclxuXHJcbiAgICAgICAgLy8gcGVyc29uXHJcbiAgICAgICAgY29uc3QgbGFzdE5hbWUgPSBkb2N1bWVudERhdGEubGFzdE5hbWU7XHJcbiAgICAgICAgY29uc3QgZmlyc3ROYW1lID0gZG9jdW1lbnREYXRhLmZpcnN0TmFtZTtcclxuICAgICAgICAvLyBjb25zdCBtaWRkbGVOYW1lID0gZG9jdW1lbnREYXRhLm1pZGRsZU5hbWU7XHJcbiAgICAgICAgY29uc3QgZGF0ZU9mQmlydGggPSBkb2N1bWVudERhdGEuZG9iO1xyXG4gICAgICAgIGNvbnN0IGdlbmRlciA9IGRvY3VtZW50RGF0YS5nZW5kZXI7XHJcbiAgICAgICAgbGV0IGdlbmRlclN0cjtcclxuICAgICAgICBzd2l0Y2ggKGdlbmRlcikge1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICBjYXNlIE5ldHZlcmlmeUdlbmRlclVua25vd246IHtcclxuICAgICAgICAgICAgICAgIGdlbmRlclN0ciA9IFwiVW5rbm93blwiO1xyXG4gICAgICAgICAgICB9IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIE5ldHZlcmlmeUdlbmRlckY6IHtcclxuICAgICAgICAgICAgICAgIGdlbmRlclN0ciA9IFwiZmVtYWxlXCI7XHJcbiAgICAgICAgICAgIH0gYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgTmV0dmVyaWZ5R2VuZGVyTToge1xyXG4gICAgICAgICAgICAgICAgZ2VuZGVyU3RyID0gXCJtYWxlXCI7XHJcbiAgICAgICAgICAgIH0gYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgTmV0dmVyaWZ5R2VuZGVyWDoge1xyXG4gICAgICAgICAgICAgICAgZ2VuZGVyU3RyID0gXCJVbnNwZWNpZmllZFwiO1xyXG4gICAgICAgICAgICB9IGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBvcmlnaW5hdGluZ0NvdW50cnkgPSBkb2N1bWVudERhdGEub3JpZ2luYXRpbmdDb3VudHJ5O1xyXG4gICAgICAgICovXHJcblxyXG4gICAgICAgIHRoaXMuX3ZjLmRpc21pc3NWaWV3Q29udHJvbGxlckFuaW1hdGVkQ29tcGxldGlvbih0cnVlLCBudWxsKTtcclxuICAgICAgICB0aGlzLl9vd25lci5nZXQoKS5uZXR2ZXJpZnlWaWV3Q29udHJvbGxlci5kZXN0cm95KCk7XHJcbiAgICB9XHJcbiAgfSJdfQ==